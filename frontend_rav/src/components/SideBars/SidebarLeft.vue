<template>
	<div class="bg-azulBarraApe w-56 md:w-60 lg:w-72 rounded-[35px] ml-2 mt-2  h-[930px]">
		<!-- Barra lateral izquierda -->
		<div>
			<!-- Ícono centrado -->
			<div class="py-8 hidden lg:flex items-center h-auto justify-center">
				<img src="@/assets/images/LogoApe.svg" alt="logo RAV" />
			</div>
			<!-- Menu de navegación -->
			<nav>
				<div class="lg:hidden flex ml-6 pt-4 ">
					<span class="text-azulBarraApe font-bold"> Menú Principal </span>
				</div>
				<ul class="list-none flex flex-col px-0 ">
					<li
						v-for="item in menuItems"
						:key="item.title"
						class="py-0.5 md:py-2 relative w-full  "
						@click="item.submenu ? toggleSubmenu(item) : handleItemClick(item)">
						<router-link
							v-if="item.to"
							:to="item.to"
							@click="setActive(item)"
							class="px-6 h-10 md:h-16"
							:class="[
								'flex flex-row  items-center transform text-white transition-colors duration-200  rounded-full ml-2 mr-2',
								isActive(item) ? 'bg-amarillo text-azulBarraApe' : '',
							]">
							<span
								v-if="item.icon"
								v-html="item.icon"
								:class="{
									'text-GrisIconosDash': !isActive(item),
									'text-azulBarraApe': isActive(item),
								}"
								class="inline-flex items-center justify-center h-4 md:h-7 lg:h-12 w-4 md:w-7 lg:w-12 text-lg mr-4 transition-colors duration-200">
							</span>

							<span
								class="text-left text-sm md:text-md lg:text-lg transition-colors duration-200"
								:class="{ 'text-azulBarraApe': isActive(item) }"
								>{{ item.title }}</span
							>
							<span v-if="item.submenu" class="ml-auto">
								<svg
									:class="
										{ 'rotate-180': item.submenuOpen } && {
											'text-azulBarraApe': isActive(item),
										}
									"
									class="transform transition-transform"
									width="13"
									height="9"
									viewBox="0 0 13 9"
									fill="none"
									xmlns="http://www.w3.org/2000/svg">
									<path
										d="M6.75 8.23077L0 0.230774L13 0.230774L6.75 8.23077Z"
										fill="currentColor" />
								</svg>
							</span>
						</router-link>

						<!-- Submenú -->
						<ul
							v-if="item.submenu"
							class="pl-14 pr-3 overflow-hidden transition-all duration-300 list-none bg-azulBarraApe"
							:style="{ maxHeight: item.submenuOpen ? '200px' : '0px' }">
							<li
								v-for="submenuItem in item.submenu"
								:key="submenuItem.title"
								class="py-1">
								<router-link
									v-if="submenuItem.to"
									:to="submenuItem.to"
									@click="setActive(item.submenu)"
									class="flex flex-row items-center px-4 h-10 text-base font-light text-amarillo"
									:class="[
										'flex flex-row  items-center transform text-amarillo transition-colors duration-200 ',
										isActive(item.submenu)
											? 'bg-amarillo text-azulBarraApe'
											: '',
									]">
									<span
										v-if="submenuItem.icon"
										v-html="submenuItem.icon"
										class="inline-flex items-center justify-center h-4 md:h-6 lg:h-8 w-4 md:w-6 lg:w-8 mr-4">
									</span>
									<span>{{ submenuItem.title }}</span>
								</router-link>
							</li>
						</ul>
					</li>

					<li>
						<div
							class="cursor-pointer flex lg:hidden mt-0 ml-6 mb-2 gap-1"
							@click="logout">
							<img
								class="w-4 h-auto"
								:src="IconoLogout"
								alt="IconoLogoutResponsive" />
							<span
								class="text-left mt-1 ml-0.5 text-black text-sm md:text-base lg:text-lg font-semibold"
								>Cerrar Sesión</span
							>

							<div class="mt-1 ml-12">
								<svg
									width="12"
									height="10.5"
									viewBox="0 0 12 11"
									fill="none"
									xmlns="http://www.w3.org/2000/svg">
									<path
										d="M7.49999 10.5L7.49999 9.00003L1.49997 9.00002L1.49997 1.5L7.49999 1.5L7.49999 -5.16178e-06L-3.81827e-05 -5.81745e-06L-3.91006e-05 10.5L7.49999 10.5ZM8.99999 7.50002L12 5.25001L8.99999 3.00001L8.99999 4.50001L2.99997 4.50001L2.99997 6.00001L8.99999 6.00001L8.99999 7.50002Z"
										fill="black" />
								</svg>
							</div>
						</div>
					</li>
					<li class="lg:hidden">
						<Notifications />
					</li>
				</ul>
				<!-- Sección inferior con el avatar, nombre y email -->
				<div class="hidden lg:block p-4 border text:sm flex-shrink-0">
					<div class="flex items-center justify-center">
						<Avatar
							:src="user.avatar"
							alt="User Avatar"
							class="w-12 h-12 rounded-full" />
						<div class="text-xs text-center ml-3">
							<p class="font-bold text-lg">{{ user.name }}</p>
						</div>
					</div>
					<p class="text-gray-700 text-sm">{{ user.email }}</p>
					<!-- Botón de Cerrar Sesión -->
					<div class="mt-4 text-center">
						<LogoutButton
							@click="logout"
							class="text-base !text-amarillo !font-bold py-1 px-2" />
					</div>
				</div>
			</nav>
		</div>
	</div>
</template>
<script setup>
import { ref, onMounted, onUnmounted, watch } from "vue";
import { useAuthStore } from "../../stores/auth";
import Avatar from "@/components/Buttons/Avatar.vue";
import LogoutButton from "@/components/Buttons/LogoutButton.vue";
import axios from "axios";
import { useRoute, useRouter } from "vue-router";
import { useToast } from "vue-toastification";
import IconoLogout from "@/assets/iconosDash/malecostume-512.svg";
import Notifications from "./Notifications.vue";

const router = useRouter();
const route = useRoute();
const toast = useToast();
const authStore = useAuthStore();

const user = ref({
	name: "Amy Elsner",
	email: "amy.elsner@example.com",
	avatar: "https://primefaces.org/cdn/primevue/images/avatar/amyelsner.png",
});

const menuItems = ref([
	{
		title: "Inicio",
		to: { name: "HomePage" },
		icon: `
		  <svg width="34" height="34" viewBox="0 0 34 34" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
		<path d="M17 0C7.65 0 0 7.65 0 17C0 26.35 7.65 34 17 34C26.35 34 34 26.35 34 17C34 7.65 26.35 0 17 0ZM17 4.25C24.055 4.25 29.75 9.945 29.75 17C29.75 24.055 24.055 29.75 17 29.75C9.945 29.75 4.25 24.055 4.25 17C4.25 9.945 9.945 4.25 17 4.25ZM17 8.5C15.81 8.5 14.875 9.435 14.875 10.625C14.875 11.815 15.81 12.75 17 12.75C18.19 12.75 19.125 11.815 19.125 10.625C19.125 9.435 18.19 8.5 17 8.5ZM9.945 12.75C9.59311 12.863 9.27678 13.0658 9.02722 13.3384C8.77767 13.611 8.60353 13.944 8.52199 14.3045C8.44046 14.6649 8.45434 15.0404 8.56229 15.3939C8.67023 15.7474 8.86849 16.0666 9.1375 16.32L13.005 20.1875C12.92 20.5275 12.75 20.8675 12.75 21.25C12.75 23.5875 14.6625 25.5 17 25.5C19.3375 25.5 21.25 23.5875 21.25 21.25C21.25 18.9125 19.3375 17 17 17C16.6175 17 16.2775 17.17 15.9375 17.255L12.07 13.3875C11.8375 13.1302 11.5455 12.9336 11.2195 12.8151C10.8935 12.6966 10.5435 12.6596 10.2 12.7075C10.1151 12.7024 10.0299 12.7024 9.945 12.7075V12.75ZM23.375 12.75C22.185 12.75 21.25 13.685 21.25 14.875C21.25 16.065 22.185 17 23.375 17C24.565 17 25.5 16.065 25.5 14.875C25.5 13.685 24.565 12.75 23.375 12.75Z" fill="currentColor"/>
		</svg>`,
	},
	{
		title: "Búsqueda del Ciudadano",
		to: { name: "BusquedaCiudadanoPage" },
		icon: `<svg width="34" height="34" viewBox="0 0 34 34" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M11.3215 0.0224217C20.8956 -0.55239 27.2974 10.0419 22.3381 18.337C22.0487 18.8205 21.2592 19.6839 21.0965 20.0591C21.0678 20.1264 21.0295 20.1793 21.063 20.2563L23.4506 22.6614C24.3931 22.1058 25.3285 22.0769 26.2113 22.76C28.3117 25.2348 31.4241 27.5004 33.4146 29.9944C35.2734 32.3249 32.3117 35.2904 30.0294 33.3976C27.5247 31.322 25.2759 28.2796 22.7879 26.115C22.2281 25.3334 22.1778 24.304 22.6874 23.4839L20.2281 20.9297C14.3047 26.6442 4.38142 24.6287 1.0274 17.1225C-2.32662 9.61625 2.90297 0.527487 11.3215 0.0224217ZM11.4077 2.46597C4.06325 2.94699 -0.16158 11.3503 4.01779 17.5169C8.19716 23.6835 16.788 23.1424 20.3429 16.9421C24.1563 10.2945 18.9913 1.97053 11.4077 2.46597Z" fill="currentColor"/>
<path d="M11.6412 4.60523C17.3634 4.25494 18.4664 12.5748 12.8443 13.6738C6.41237 14.9307 5.14647 5.00131 11.6412 4.60523Z" fill="currentColor"/>
<path d="M15.567 12.8647C16.6449 13.3353 17.6353 14.4543 18.0938 15.6083C18.3538 16.2641 18.5642 16.6371 18.1222 17.2128C15.4701 20.6772 10.4355 21.1704 7.08142 18.557C6.76468 18.3117 5.63957 17.2704 5.52847 16.9425C5.39374 16.5445 6.21631 15.05 6.47395 14.6796C6.74341 14.2891 7.82598 13.1026 8.22071 12.9824C8.45472 12.9123 9.09527 13.5381 9.36473 13.6883C11.3691 14.8197 13.9077 14.4993 15.5694 12.8647H15.567Z" fill="currentColor"/>
</svg>

`,
		submenuOpen: false,
		submenu: [
			{
				title: "Perfil del Ciudadano",
				to: { name: "PerfilCiudadanoPage" },
				icon: `<svg width="21" height="26" viewBox="0 0 21 26" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M20.9638 25.6793C20.9979 25.6543 21 25.6501 21 25.6127C21 25.2194 20.9808 24.8199 20.9787 24.4246C20.9744 23.5632 20.9467 22.8516 20.7633 22.0006C20.0383 18.6215 17.4817 15.7522 14.1553 14.5891C11.8545 15.6648 9.15715 15.6669 6.85852 14.5849C3.47881 15.7772 0.907244 18.7151 0.222773 22.1629C0.00527763 23.2552 0.0756416 24.152 0.0415249 25.2402C0.0372601 25.3796 -0.0586929 25.5648 0.0564518 25.6772H20.9638V25.6793Z" fill="#FDC300"/>
<path d="M10.6745 0.332416C5.39253 0.0274982 1.83314 5.7553 4.44026 10.3799C6.7765 14.5196 12.6277 14.9939 15.5776 11.2481C18.9614 6.95168 16.1067 0.645805 10.6745 0.332416Z" fill="#FDC300"/>
</svg>

`,
			},
			{
				title: "Ruta de Atención",
				to: { name: "RutaAtencionPage" },
				icon: `<svg width="30" height="26" viewBox="0 0 30 26" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M29.9969 7.63207C29.8586 8.18942 29.786 8.77472 29.565 9.29558C29.3084 9.91797 28.9746 10.5053 28.5716 11.0437C27.0159 13.062 25.4184 15.0476 23.8356 17.0457C23.7946 17.0977 23.7498 17.1474 23.6911 17.2149C23.6239 17.1373 23.5667 17.0752 23.5142 17.0084C21.8634 14.9126 20.1501 12.8695 18.575 10.7208C15.903 7.07239 17.8797 1.80396 22.4304 0.843733C25.8355 0.126475 29.1139 2.31862 29.8655 5.74422C29.9181 5.98176 29.9559 6.2224 30 6.46148L29.9969 7.63207ZM23.6803 14.2302C23.739 14.165 23.7668 14.1379 23.7908 14.1076C24.941 12.6521 26.1036 11.2067 27.2376 9.73805C28.017 8.72892 28.2727 7.57075 28.078 6.30856C27.6918 3.80592 25.158 2.08263 22.7232 2.67103C19.4479 3.46281 18.1563 7.23308 20.2512 9.89485C21.0237 10.8768 21.8024 11.8549 22.578 12.8345L23.6803 14.2302Z" fill="#FDC300"/>
<path d="M6.3154 17.1108C5.53157 16.123 4.77325 15.1725 4.01802 14.215C3.07959 13.0265 2.1056 11.8674 1.21509 10.6479C-1.49043 6.95745 0.557264 1.673 5.03375 0.737214C9.10596 -0.115616 12.9239 3.23446 12.6139 7.39239C12.5285 8.65875 12.0589 9.8686 11.2681 10.8595C9.64681 12.911 8.02349 14.9603 6.39811 17.0077L6.3154 17.1108ZM6.30999 14.1042C6.34298 14.0756 6.37446 14.0453 6.4043 14.0134C7.5499 12.5683 8.70245 11.1286 9.83723 9.67177C10.635 8.64837 10.9063 7.48077 10.7076 6.19765C10.3211 3.70274 7.77948 1.98312 5.34296 2.5739C2.06772 3.37091 0.780664 7.13421 2.87861 9.79427C3.95567 11.1583 5.0353 12.52 6.11751 13.8793C6.17626 13.9514 6.23965 14.022 6.30999 14.1042Z" fill="#FDC300"/>
<path d="M9.04301 22.4801C9.05823 24.0004 7.82537 25.2783 6.32843 25.2923C4.83149 25.3063 3.60396 24.0449 3.58874 22.5051C3.57504 20.9816 4.80638 19.7069 6.30332 19.6944C7.80026 19.682 9.02779 20.9388 9.04301 22.4801ZM6.30865 23.4157C6.48662 23.4154 6.66054 23.3612 6.80856 23.2599C6.95659 23.1587 7.07212 23.0149 7.14067 22.8467C7.20921 22.6784 7.22771 22.4931 7.19384 22.3141C7.15996 22.1351 7.07524 21.9704 6.95028 21.8405C6.82533 21.7107 6.66572 21.6215 6.49149 21.5843C6.31727 21.5471 6.13619 21.5634 5.97098 21.6312C5.80577 21.699 5.66381 21.8154 5.5629 21.9655C5.46199 22.1157 5.40663 22.2931 5.40378 22.4754C5.40216 22.7232 5.49651 22.9614 5.66615 23.138C5.83578 23.3146 6.06684 23.415 6.30865 23.4172V23.4157Z" fill="#FDC300"/>
<path d="M26.4099 22.64C26.3589 24.2037 25.1159 25.4463 23.6414 25.3948C22.1236 25.3441 20.9095 24.0579 20.9582 22.5527C21.01 20.9889 22.2484 19.7565 23.7275 19.7994C25.2415 19.8422 26.4579 21.1308 26.4099 22.64ZM23.6909 23.5208C23.8689 23.5175 24.042 23.4603 24.1883 23.3566C24.3347 23.2528 24.4479 23.1071 24.5137 22.9377C24.5795 22.7683 24.595 22.5828 24.5582 22.4045C24.5214 22.2261 24.434 22.0628 24.3069 21.9352C24.1798 21.8075 24.0188 21.7211 23.8439 21.6869C23.6691 21.6526 23.4882 21.672 23.3241 21.7427C23.16 21.8133 23.0199 21.932 22.9215 22.0839C22.823 22.2357 22.7705 22.414 22.7706 22.5963C22.7734 22.8437 22.8719 23.0799 23.0443 23.2532C23.2168 23.4265 23.4493 23.5227 23.6909 23.5208Z" fill="#FDC300"/>
<path d="M10.423 21.6356L12.8477 21.6121L12.8489 23.4609L10.425 23.4845L10.423 21.6356Z" fill="#FDC300"/>
<path d="M13.7797 21.6025L16.1995 21.6124L16.2206 23.3501L13.7995 23.343L13.7797 21.6025Z" fill="#FDC300"/>
<path d="M19.5783 21.6126L19.5777 23.4571L17.1497 23.4839L17.1505 21.6386L19.5783 21.6126Z" fill="#FDC300"/>
<path d="M25.8372 7.02972C25.829 7.59855 25.5986 8.1416 25.1952 8.54278C24.7919 8.94397 24.2476 9.17146 23.6787 9.17663C22.507 9.17201 21.5241 8.18373 21.531 7.01815C21.538 5.85257 22.5247 4.86352 23.6895 4.87046C24.2586 4.87869 24.8018 5.10919 25.2031 5.51268C25.6045 5.91617 25.832 6.46064 25.8372 7.02972Z" fill="#FDC300"/>
<path d="M6.32876 9.07238C5.16364 9.08394 4.17113 8.10591 4.16265 6.93288C4.15418 5.75986 5.12819 4.77951 6.30256 4.76641C7.47693 4.7533 8.4548 5.73057 8.46868 6.90668C8.48178 8.07045 7.50313 9.06159 6.32876 9.07238Z" fill="#FDC300"/>
</svg>

`,
			},
			{
				title: "Linea de Tiempo",
				to: { name: "LineaTiempoNuevaPage" },
				icon: `<svg width="30" height="12" viewBox="0 0 30 12" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M4.89112 0.547137C6.5833 0.404526 8.22445 1.00575 9.38795 2.23899C9.78701 2.32414 10.8239 2.13228 11.1403 2.28721C11.2628 2.34671 11.7323 2.86278 11.866 2.99924C12.6519 3.80566 13.3928 4.65928 14.193 5.45237C14.4481 5.79607 14.4726 6.11515 14.2124 6.46604C13.7133 7.13703 12.8427 7.91678 12.2477 8.54571C12.0813 8.72218 11.916 8.94174 11.7486 9.11616C11.6333 9.23722 11.274 9.63633 11.1618 9.69892C10.8648 9.86718 9.7768 9.67737 9.38795 9.75842C5.59739 13.6972 -0.932501 10.3371 0.111587 4.89115C0.547389 2.61552 2.58045 0.741048 4.8901 0.546111L4.89112 0.547137ZM8.2765 3.30704C7.75088 2.75813 7.17321 2.40007 6.43123 2.19692C6.33733 2.11792 6.52002 1.61519 6.11075 1.41307C5.90459 1.3115 5.25956 1.31765 5.01564 1.34228C4.75538 1.36895 4.53799 1.52387 4.50125 1.79679C4.48594 1.91375 4.53697 2.10458 4.45022 2.18153C4.40531 2.22154 3.95726 2.35697 3.84193 2.40827C0.563719 3.8744 0.860717 8.72218 4.28284 9.75124C8.16423 10.9188 11.0209 6.17671 8.2765 3.30704Z" fill="#FDC300"/>
<path d="M17.5579 2.25641C17.8681 2.21948 18.1743 2.2677 18.4836 2.28206C18.6571 2.29027 18.8857 2.2123 19.049 2.3467L21.9649 5.41439C22.415 5.97971 22.1517 6.31931 21.7495 6.77177C21.0545 7.55152 20.2972 8.28817 19.5818 9.04945C19.4736 9.16436 19.0663 9.67325 18.9673 9.70506C18.7459 9.76764 18.5377 9.71121 18.3142 9.7184C18.0029 9.72968 17.7232 9.7184 17.417 9.7184C16.3515 9.71532 15.285 9.72763 14.2195 9.71532L14.1817 9.65273L17.166 6.48552C17.4619 6.07307 17.3905 5.73553 17.0833 5.36207L14.1664 2.32926C14.198 2.28104 14.2307 2.28309 14.2807 2.27693C15.3064 2.16407 16.5179 2.38466 17.5589 2.25539L17.5579 2.25641Z" fill="#FDC300"/>
<path d="M25.1544 2.25937C25.4535 2.25732 25.7515 2.25116 26.0475 2.245C26.2352 2.24193 26.6282 2.22141 26.7833 2.31169L29.7645 5.41427C30.2473 6.02473 29.9044 6.37151 29.4828 6.83834C28.7837 7.6109 28.053 8.38142 27.3334 9.13449C27.2406 9.23093 26.8384 9.66492 26.7639 9.70186C26.6037 9.77983 26.2056 9.75726 26.0158 9.75316C25.7311 9.74803 25.4422 9.7429 25.1544 9.74084C24.1103 9.73469 23.0642 9.70596 22.0201 9.71519L21.9824 9.65261L24.9656 6.4854C25.3177 6.02678 25.1514 5.68616 24.8166 5.29628L21.967 2.33119L22.0814 2.27886C23.106 2.30041 24.1318 2.26552 25.1554 2.25937H25.1544Z" fill="#FDC300"/>
<path d="M7.15479 3.99747C7.72735 3.88666 7.99169 4.62845 7.49465 4.9424L5.94638 5.9335L5.92188 8.55592C5.83309 9.13047 5.01558 9.10379 4.93291 8.49436C4.98598 7.58534 4.85228 6.57782 4.92883 5.68111C4.94924 5.44103 5.01252 5.3292 5.19929 5.18145C5.52487 4.92291 6.54854 4.27346 6.92004 4.09596C6.97924 4.06724 7.09865 4.00875 7.15479 3.99747Z" fill="#FDC300"/>
</svg>

`,
			},
			{
				title: "Registro de Actividad",
				to: { name: "RegistroActividadPage" },
				icon: `<svg width="38" height="38" viewBox="0 0 38 38" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M0 23.6681V23.4077C0.00727383 23.3956 0.0206094 23.3848 0.0206094 23.3727C0.0815421 22.7965 0.344652 22.26 0.763752 21.8575C1.89524 20.6978 3.02874 19.5422 4.16427 18.3906L6.84831 15.6626L11.3217 11.1168C12.5445 9.87275 13.7673 8.62911 14.9901 7.38588C16.3059 6.04862 17.6216 4.71296 18.9374 3.37892C19.5654 2.74123 20.1849 2.09751 20.8177 1.46705C21.1814 1.10541 21.562 0.743771 21.9524 0.412269C22.2143 0.185641 22.5501 0.0904098 22.881 0H23.4047C23.4108 0.00723279 23.4157 0.0180815 23.4229 0.0192869C23.9854 0.120546 24.4304 0.429144 24.8244 0.818509C25.1678 1.15845 25.5065 1.50281 25.8403 1.85159C26.5604 2.60139 27.2744 3.35481 27.9933 4.1034C28.0215 4.12765 28.0402 4.16107 28.046 4.19771C28.0517 4.23435 28.0442 4.27184 28.0248 4.30351C27.8236 4.78569 27.609 5.26788 27.4393 5.76332C27.2178 6.37396 27.1548 7.03031 27.2562 7.67157C27.409 8.55518 27.9194 9.21819 28.5898 9.77873C29.2222 10.3414 30.0516 10.6344 30.8992 10.5948C31.5095 10.5586 32.1072 10.406 32.6595 10.1452C33.051 9.97039 33.4281 9.76546 33.8184 9.57018C33.8347 9.58196 33.8501 9.59485 33.8645 9.60876C34.4549 10.1789 35.0526 10.7431 35.6345 11.3229C36.2855 11.9703 36.9316 12.6224 37.5608 13.2902C37.7291 13.4722 37.8543 13.6893 37.9271 13.9257C37.9999 14.162 38.0185 14.4116 37.9815 14.656C37.9137 15.2155 37.6573 15.7356 37.2541 16.1315C36.7692 16.6414 36.2697 17.1417 35.7751 17.6444C34.8133 18.6208 33.8524 19.5952 32.8922 20.5676C31.0035 22.4883 29.1139 24.4058 27.2235 26.3201C26.3911 27.1679 25.5582 28.0158 24.7249 28.8636C23.0916 30.5232 21.4578 32.1827 19.8236 33.8422C19.0679 34.6097 18.3127 35.378 17.5578 36.147C17.1468 36.5629 16.748 36.9909 16.3116 37.3802C15.3938 38.1951 14.3719 38.2036 13.4251 37.4224C13.1644 37.2079 12.9268 36.9656 12.6831 36.7305C11.9048 35.9795 11.1326 35.2213 10.3519 34.4715C9.8524 33.9893 9.81239 33.794 10.0912 33.1611C10.5968 32.0147 10.6246 30.8599 10.0233 29.7484C9.32141 28.449 8.20487 27.7739 6.70889 27.8197C6.22397 27.8342 5.74632 27.9776 5.26383 28.0499C4.98191 28.101 4.71388 28.2102 4.47704 28.3706C4.34369 28.455 4.20912 28.537 4.0794 28.6177C4.06724 28.6108 4.0555 28.6031 4.04425 28.5948C2.88044 27.3628 1.71177 26.1345 0.556448 24.894C0.390293 24.7003 0.254221 24.4829 0.152751 24.2491C0.0841048 24.0605 0.0329743 23.866 0 23.6681ZM16.4692 26.1272C16.5104 26.0754 16.5407 26.0392 16.5674 26.0007C17.1602 25.1568 17.7554 24.313 18.3434 23.4632C18.3726 23.4127 18.4158 23.3717 18.4678 23.345C18.5198 23.3183 18.5785 23.307 18.6368 23.3125C19.6393 23.3245 20.6419 23.3293 21.6445 23.3354H21.9088C21.8542 23.2606 21.8227 23.2148 21.7875 23.169C21.1632 22.3457 20.5401 21.5224 19.9109 20.7026C19.88 20.6678 19.8599 20.6247 19.853 20.5788C19.8461 20.5328 19.8527 20.4858 19.8721 20.4435C20.2067 19.4542 20.5385 18.4637 20.8674 17.472C20.8819 17.4298 20.8916 17.3852 20.9062 17.3273L20.8322 17.349C19.8171 17.697 18.8032 18.0466 17.7906 18.3978C17.7476 18.4178 17.6996 18.4248 17.6526 18.418C17.6056 18.4111 17.5617 18.3907 17.5263 18.3592C16.6874 17.7388 15.846 17.1208 15.0023 16.5052C14.9623 16.4763 14.9198 16.4498 14.881 16.4232C14.881 16.6897 14.881 16.9392 14.881 17.1899C14.8932 18.0229 14.9029 18.8559 14.9247 19.6901C14.9295 19.7375 14.9207 19.7854 14.8992 19.8281C14.8778 19.8708 14.8445 19.9065 14.8034 19.9311C13.9516 20.5347 13.103 21.1402 12.2576 21.7478C12.22 21.7743 12.1861 21.8044 12.1364 21.8466L12.3061 21.9009C13.3099 22.2059 14.3137 22.5036 15.3163 22.817C15.35 22.8295 15.3808 22.8486 15.4068 22.8733C15.4329 22.8979 15.4536 22.9276 15.4678 22.9605C15.6411 23.48 15.8048 24.0044 15.9709 24.5276C16.137 25.0508 16.2958 25.5836 16.4692 26.1272ZM28.3837 16.5968L26.981 17.953L30.0858 21.2547L31.4957 19.9287C30.4507 18.8161 29.4214 17.7119 28.3837 16.5968ZM22.0106 13.2517L25.1165 16.5534L26.5252 15.2274L23.4169 11.8955L22.0106 13.2517ZM17.0401 8.59014L20.1097 11.8979L21.5863 10.6334L18.4719 7.34128L17.0401 8.59014Z" />
</svg>
`,
			},
		],
	},
	{
		title: "Mapa",
		to: { name: "DepartamentosPage" },
		icon: `<svg width="36" height="34" viewBox="0 0 36 34" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M26.7985 15.1382L30.9386 13.1449C32.4915 12.8222 32.4844 14.5829 32.7069 15.6578C33.5638 19.8199 34.3213 24.0293 35.0457 28.208C35.0362 28.5948 34.7521 28.8273 34.4775 29.0527L24.0076 33.5256L23.2501 33.4805L11.3789 29.2924L1.41319 33.5161C0.677005 33.6561 0.194106 33.3761 0 32.6595C0.733816 27.8497 1.81324 23.0636 2.69382 18.268C2.79324 17.9809 3.02285 17.746 3.27377 17.5822L8.30396 15.1382C7.76425 14.0609 7.34527 12.8744 7.1985 11.6666C6.49073 5.83883 10.9717 0.40019 16.8115 0.0229018C24.8574 -0.496759 30.4794 7.92697 26.8032 15.1382H26.7985ZM17.4317 6.49138C13.1708 6.49138 13.4075 10.5253 14.5911 13.8473L17.6684 14.3219L20.2723 13.61C21.2191 11.2371 22.8974 6.49138 17.4317 6.49138ZM29.5042 16.9321L24.4716 18.7236L23.2501 20.3324L24.2964 29.9829L25.0066 29.7456L31.3979 27.1354L29.5042 16.9321ZM3.22879 30.4575L9.85681 27.3727L10.8037 18.8304L9.41652 17.0341L4.69879 19.3856L3.22879 30.4575ZM21.9695 22.1382L18.5158 26.7558C18.0803 27.368 17.3062 27.4771 16.7405 26.9693L13.1708 21.9127L12.9341 26.8958L22.8761 30.2178L21.9695 22.1358V22.1382Z" />
</svg>
`,
	},
	{
		title: "Generar Reportes",
		to: { name: "FormatodeReportesPage" },
		icon: `<svg width="34" height="30" viewBox="0 0 34 30" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M2.125 0C0.935 0 0 0.935 0 2.125C0 3.315 0.935 4.25 2.125 4.25C3.315 4.25 4.25 3.315 4.25 2.125C4.25 0.935 3.315 0 2.125 0ZM8.5 0V4.25H34V0H8.5ZM2.125 8.5C0.935 8.5 0 9.435 0 10.625C0 11.815 0.935 12.75 2.125 12.75C3.315 12.75 4.25 11.815 4.25 10.625C4.25 9.435 3.315 8.5 2.125 8.5ZM8.5 8.5V12.75H34V8.5H8.5ZM2.125 17C0.935 17 0 17.935 0 19.125C0 20.315 0.935 21.25 2.125 21.25C3.315 21.25 4.25 20.315 4.25 19.125C4.25 17.935 3.315 17 2.125 17ZM8.5 17V21.25H34V17H8.5ZM2.125 25.5C0.935 25.5 0 26.435 0 27.625C0 28.815 0.935 29.75 2.125 29.75C3.315 29.75 4.25 28.815 4.25 27.625C4.25 26.435 3.315 25.5 2.125 25.5ZM8.5 25.5V29.75H34V25.5H8.5Z" />
</svg>
`,
	},
	{
		title: "Lista de Usuarios",
		to: { name: "ListaUsuariosPage" },
		icon: `<svg width="34" height="40" viewBox="0 0 34 40" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M20.038 32.0731C20.0246 32.0612 20.0237 32.0592 20.0237 32.0413C20.0237 31.8534 20.0313 31.6626 20.0321 31.4737C20.0338 31.0621 20.0447 30.7222 20.1167 30.3156C20.4013 28.7012 21.4051 27.3304 22.7111 26.7747C23.6145 27.2886 24.6735 27.2896 25.576 26.7727C26.903 27.3423 27.9126 28.7459 28.1814 30.3931C28.2667 30.915 28.2391 31.3435 28.2525 31.8634C28.2542 31.93 28.2919 32.0184 28.2467 32.0721H20.038V32.0731Z" fill="currentColor"/>
<path d="M24.0159 22.0654C25.8632 21.9587 27.108 23.9619 26.1962 25.5793C25.3792 27.0271 23.3328 27.1929 22.3012 25.8829C21.1178 24.3803 22.1161 22.175 24.0159 22.0654Z" fill="currentColor"/>
<path d="M19.2876 0.859619V4.0006H25.9131V10.2826H8.24507V4.0006H14.8706V0.859619H19.2876Z" fill="currentColor"/>
<path d="M12.1674 15.583H27.2821C27.4984 15.6268 27.5947 15.7175 27.6343 15.848C27.7002 16.0589 27.6963 17.5647 27.6119 17.7398C27.5736 17.817 27.4879 17.8751 27.3758 17.9157L12.1687 17.9387C12.0514 17.9181 11.9313 17.8623 11.8773 17.7963C11.7718 17.6658 11.7507 16.0573 11.8153 15.848C11.8562 15.7175 11.9524 15.6268 12.1674 15.583Z" fill="currentColor"/>
<path d="M11.9802 22.6501H19.8175C19.9297 22.6939 19.9796 22.7846 20.0001 22.9152C20.0343 23.1261 20.0322 24.6318 19.9885 24.8069C19.9686 24.8841 19.9242 24.9422 19.8661 24.9828L11.9809 25.0059C11.9201 24.9852 11.8578 24.9295 11.8298 24.8634C11.7751 24.7329 11.7641 23.1245 11.7977 22.9152C11.8189 22.7846 11.8688 22.6939 11.9802 22.6501Z" fill="currentColor"/>
<path d="M11.9227 29.7173H17.5207C17.6008 29.7611 17.6365 29.8518 17.6511 29.9823C17.6755 30.1932 17.6741 31.699 17.6428 31.8741C17.6286 31.9513 17.5969 32.0094 17.5554 32.0499L11.9231 32.073C11.8797 32.0523 11.8352 31.9966 11.8152 31.9306C11.7761 31.8 11.7683 30.1916 11.7922 29.9823C11.8074 29.8518 11.843 29.7611 11.9227 29.7173Z" fill="currentColor"/>
<path d="M7.57226 15C9.84247 14.8277 10.1345 18.3576 7.8307 18.5215C5.44424 18.6919 5.14257 15.1844 7.57226 15Z" fill="currentColor"/>
<path d="M7.56996 22.0677C9.86845 21.8908 10.1127 25.4262 7.82867 25.5891C5.48497 25.7558 5.10798 22.2567 7.56996 22.0677Z" fill="currentColor"/>
<path d="M7.55711 29.1342C9.42711 28.9903 10.2031 31.6871 8.40877 32.4745C5.8586 33.5936 4.70518 29.3534 7.55711 29.1342Z" fill="currentColor"/>
<path d="M6.71385 5.57104V8.36848H3.35692V36.3428H30.2123V8.36848H26.8554V5.57104H33.5692V39.1403H0V5.57104H6.71385Z" fill="currentColor"/>
</svg>

`,
	},
	{
		title: "Lineas de Atención",
		to: { name: "LineasAtencionPage" },
		icon: `<svg width="34" height="32" viewBox="0 0 34 32" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
 <path d="M31.5812 11.9827C31.6204 12.0333 32.4149 12.4531 32.6439 12.6582C34.4686 14.2913 34.4502 17.3829 32.5989 18.9845C32.3682 19.1844 31.7011 19.5327 31.6062 19.6898C31.373 20.0721 31.0441 21.5655 30.7992 22.1608C29.0711 26.3661 25.4126 29.7745 21.2144 31.0558C20.1476 31.3813 19.1657 31.4258 18.1322 31.6659C17.3777 31.8413 17.2786 32.1983 16.3225 31.8588C14.4529 31.1945 15.4131 28.8824 17.4243 29.2202C17.8016 29.2839 18.1156 29.6043 18.442 29.6383C20.5149 29.8591 24.3841 27.5557 25.8981 26.1016C36.862 15.5674 25.2427 -3.31018 11.409 3.14789C5.33783 5.98197 2.2731 13.2884 4.16024 19.9464C0.591663 20.1672 -1.37459 15.591 1.11716 12.8738C1.35368 12.6155 2.04324 12.2463 2.16483 12.0516C2.34888 11.7584 2.52461 10.7572 2.68201 10.3243C7.52311 -3.03437 25.4043 -3.5668 30.7992 9.52915C30.9674 9.93851 31.5046 11.8814 31.5812 11.9827Z"/>
 <path fill-rule="evenodd" clip-rule="evenodd" d="M23.9116 20.2701C27.1636 13.9883 22.3947 6.55345 15.6746 7.15084C9.89716 7.66454 6.2817 14.3856 8.9079 19.9724C11.9202 26.3809 20.6574 26.5563 23.9116 20.2701ZM25.7072 21.2721C29.7251 13.5108 23.8361 4.30101 15.5007 5.04199C8.23304 5.6882 3.84993 14.0381 7.07592 20.9008C10.8181 28.8621 21.6679 29.0749 25.7072 21.2721Z"/>
 <path d="M21 19.0709C20.1662 23.0052 12.773 22.9708 12 19C14.9 20.0052 18.0874 20.069 21 19.0709Z"/>
</svg>
`,
	},
]);

const activeItem = ref(null);
const isResponsive = ref(false);

const emit = defineEmits(["item-click"]);

// Función para actualizar el estado responsive
const updateResponsive = () => {
	isResponsive.value = window.innerWidth < 1024; // Evaluar si es menor a 1024px
};

// Método para manejar clics
const handleItemClick = (item) => {
	// Solo ejecuta el cierre en responsive
	if (isResponsive.value) {
		emit("item-click", item); // Cerrar barra desplegable
	}

	if (item.to) {
		router.push(item.to);
	}

	activeItem.value = item.title;

	// Cerrar otros submenús al seleccionar un elemento
	menuItems.value.forEach((menuItem) => {
		if (menuItem !== item && menuItem.submenu) {
			menuItem.submenuOpen = false;
		}
	});
};

// Configuración inicial
onMounted(() => {
	updateResponsive(); // Actualizar el estado al cargar la página
	window.addEventListener("resize", updateResponsive); // Escuchar cambios de tamaño
});

// Limpieza del event listener
onUnmounted(() => {
	window.removeEventListener("resize", updateResponsive);
});

// Método para alternar la apertura del submenú
const toggleSubmenu = (item) => {
	if (item.submenu) {
		item.submenuOpen = !item.submenuOpen;
	}
};

//observar cambios en la ruta actual
watch(
	() => route.name,
	(newRoute) => {
		const currentItem = menuItems.value.find(
			(item) => item.to?.name === newRoute
		);
		if (currentItem) {
			activeItem.value = currentItem.title;
		}
	},
	{ immediate: true } //ejecuta al inicia rpara que el item activo se ajuste
);
//Metodos par estabelecer el elemento activo del Dashboard
const setActive = (item) => {
	if (item.to) {
		router.push(item.to);
	}
	activeItem.value = item.title;
};
//Computed para verificar si un elemento esta activo
const isActive = (item) => {
	return activeItem.value === item.title || route.name === item.to?.name;
};
const hasShownNoSessionToast = ref(false);

const logout = async () => {
	authStore.logout();
	// Si no hay token y el mensaje azul no se ha mostrado, mostrarlo una vez
	if (!hasShownNoSessionToast.value) {
		toast.info("No hay sesión activa.");
		hasShownNoSessionToast.value = true;
	}
	router.push({ name: "LoginPage" });
	return;

	try {
		// Configurar la petición con el token
		const config = {
			headers: {
				Authorization: `Bearer ${token}`,
			},
		};
		// Hacer la petición de logout
		await axios.post("http://localhost:8080/api/auth/logout", {}, config);
		// Limpiar el token
		localStorage.removeItem("token");
		hasShownNoSessionToast.value = false; // Resetear el flag después de cerrar sesión
		// Mostrar mensaje de éxito
		toast.success("Sesión cerrada con éxito.");
		// Redirigir al login
		router.push({ name: "LoginPage" });
	} catch (error) {
		console.error("Error al cerrar sesión:", error);
		// Si ocurre un error en el logout, solo limpiar el token y redirigir al login sin mostrar otro mensaje
		localStorage.removeItem("token");
		router.push({ name: "LoginPage" });
	}
};
</script>
<style scoped>
a {
	text-decoration: none; /* Elimina subrayado en enlaces */
}
</style>